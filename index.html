<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Government Los-Santos Orders</title>
<link rel="icon" type="image/png" href="favicon.png">

<style>
*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Arial Nova', Arial, sans-serif;
  background:
    linear-gradient(135deg,rgba(15,35,70,.9),rgba(5,15,40,.9)),
    url("https://i.imgur.com/3qsJXDT.jpeg");
  background-size:cover;
  background-attachment:fixed;
  min-height:100vh;
  padding:24px;
  color:#e0e0e0;
}

h1{
  text-align:center;
  margin-bottom:12px;
  font-size:36px;
  color:#ffffff;
  text-shadow:0 0 20px rgba(100,180,255,.5);
  letter-spacing:2px;
}

.subtitle{
  text-align:center;
  margin-bottom:32px;
  color:#a0c0ff;
  font-size:14px;
  letter-spacing:1px;
}

.main-layout{
  max-width:1400px;
  margin:auto;
  display:grid;
  grid-template-columns:1fr 360px;
  gap:24px;
  align-items:start;
}

aside{
  position:sticky;
  top:24px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.catalog{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:24px;
}

.category-title{
  grid-column:1/-1;
  font-size:28px;
  font-weight:700;
  margin:36px 0 16px;
  padding-bottom:12px;
  border-bottom:2px solid rgba(100,180,255,.4);
  color:#a0d4ff;
  text-transform:uppercase;
  letter-spacing:1px;
}

.card{
  background:linear-gradient(135deg,rgba(20,50,100,.4),rgba(10,30,70,.4));
  border:1px solid rgba(100,180,255,.3);
  border-radius:14px;
  padding:18px;
  transition:all .3s ease;
}

.card:hover{
  background:linear-gradient(135deg,rgba(30,70,130,.5),rgba(15,40,90,.5));
  border-color:rgba(100,180,255,.6);
  box-shadow:0 0 20px rgba(100,180,255,.2);
}

.card img{
  width:100%;
  height:200px;
  object-fit:cover;
  border-radius:10px;
  border:1px solid rgba(100,180,255,.2);
}

.card h3{
  margin:12px 0 8px;
  color:#ffffff;
  font-size:16px;
}

.card p{
  margin:0 0 12px;
  color:#b0d0ff;
  font-size:13px;
  line-height:1.4;
}

.price{
  font-size:22px;
  font-weight:700;
  margin:12px 0 8px;
  color:#5dd4ff;
  text-shadow:0 0 10px rgba(93,212,255,.5);
}

.qty-input{
  width:100%;
  max-width:90px;
  padding:8px;
  margin-top:8px;
  text-align:center;
  border-radius:8px;
  border:1px solid rgba(100,180,255,.3);
  background:rgba(0,20,50,.6);
  color:#a0d4ff;
  outline:none;
  font-size:15px;
  font-weight:600;
}

.qty-input:focus{
  border-color:rgba(100,180,255,.7);
  box-shadow:0 0 10px rgba(100,180,255,.3);
}

.text-input{
  width:100%;
  padding:10px;
  margin-top:8px;
  border-radius:10px;
  border:1px solid rgba(100,180,255,.3);
  background:rgba(0,20,50,.6);
  color:#ffffff;
  outline:none;
  font-size:14px;
}

.text-input:focus{
  border-color:rgba(100,180,255,.7);
  box-shadow:0 0 10px rgba(100,180,255,.3);
}

input::placeholder{color:rgba(160,192,255,.5)}

.btn{
  margin-top:10px;
  padding:10px;
  background:linear-gradient(135deg,rgba(50,100,200,.8),rgba(30,70,160,.8));
  color:#ffffff;
  border:1px solid rgba(100,180,255,.5);
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
  transition:all .3s ease;
  text-transform:uppercase;
  font-size:13px;
  letter-spacing:.5px;
}

.btn:hover{
  background:linear-gradient(135deg,rgba(70,130,230,.9),rgba(50,90,190,.9));
  border-color:rgba(100,180,255,.8);
  box-shadow:0 0 15px rgba(100,180,255,.4);
}

.btn:active{
  transform:scale(.97);
}

.btn-del{
  background:rgba(220,50,50,.6);
  border:1px solid rgba(220,100,100,.4);
  padding:4px 8px;
  margin:0;
}

.btn-del:hover{
  background:rgba(240,70,70,.8);
  border-color:rgba(240,100,100,.6);
  box-shadow:0 0 10px rgba(240,70,70,.3);
}

.info-box{
  background:linear-gradient(135deg,rgba(20,50,100,.5),rgba(10,30,70,.5));
  border:1px solid rgba(100,180,255,.3);
  border-radius:14px;
  padding:18px;
}

.info-box h2{
  color:#a0d4ff;
  text-transform:uppercase;
  letter-spacing:.5px;
  font-size:14px;
  margin-bottom:12px;
}

.info-box p{
  margin:8px 0;
  color:#e0e0e0;
  font-size:13px;
  line-height:1.6;
}

.info-box strong{
  color:#5dd4ff;
}

details summary{
  cursor:pointer;
  list-style:none;
  user-select:none;
}

details summary::-webkit-details-marker{display:none}

details summary h2{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin:0;
  padding:0;
}

details summary h2::after{
  content:"‚ñæ";
  font-size:16px;
  transition:.25s;
  color:#a0d4ff;
}

details:not([open]) summary h2::after{
  transform:rotate(-90deg);
}

details[open] .info-box{
  border-color:rgba(100,180,255,.5);
}

.category-menu{
  display:flex;
  flex-direction:column;
  gap:8px;
  margin-top:12px;
}

.category-menu a{
  color:#a0d4ff;
  text-decoration:none;
  padding:8px 12px;
  border-radius:8px;
  background:rgba(30,60,120,.4);
  font-size:13px;
  border-left:3px solid transparent;
  transition:all .2s ease;
}

.category-menu a:hover{
  background:rgba(40,80,150,.5);
  color:#ffffff;
}

.category-menu a.active{
  background:linear-gradient(90deg,rgba(93,212,255,.3),rgba(50,100,200,.2));
  color:#5dd4ff;
  border-left-color:#5dd4ff;
  font-weight:700;
}

.cart-item{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px;
  background:rgba(0,20,50,.4);
  border-radius:8px;
  margin-bottom:8px;
  border-left:3px solid rgba(93,212,255,.5);
  font-size:13px;
}

.cart-item span{
  color:#a0d4ff;
}

@media(max-width:900px){
  .main-layout{grid-template-columns:1fr}
  aside{position:static}
  h1{font-size:28px}
  .category-title{font-size:22px}
}
</style>
</head>

<body>

<h1>‚öñÔ∏è GOVERNMENT ORDERS</h1>
<div class="subtitle">–ü—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã –õ–æ—Å-–°–∞–Ω—Ç–æ—Å–∞</div>

<div class="main-layout">

  <div id="catalog" class="catalog"></div>

  <aside>

    <details open class="info-box">
      <summary><h2>üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2></summary>
      <nav id="categoryMenu" class="category-menu"></nav>
    </details>

    <div class="info-box">
      <h2>üõí –ó–∞–∫–∞–∑</h2>
      <div id="cart"></div>
      <p style="margin-top:12px;padding-top:12px;border-top:1px solid rgba(100,180,255,.2);">
        <strong>–û–±—â–∞—è —Å—É–º–º–∞:</strong><br>
        <span style="font-size:20px;color:#5dd4ff;">$<span id="total">0</span></span>
      </p>

      <input id="customerName" class="text-input" placeholder="–§–ò–û –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è">
      <input id="customerPhone" class="text-input" placeholder="–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä">
      <input id="customerEmail" class="text-input" placeholder="Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)">

      <button class="btn" onclick="sendOrder()" style="width:100%;margin-top:16px;">
        üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑
      </button>
    </div>

  </aside>

</div>

<script>
const SCRIPT_URL = atob('aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9Ba0Z5Y2J3RE50UG9iQU9Mam8tOC1QWVFiYkZCTkdkcW0tYVppR0FfN3dyLTVKLW9janhyRTVfN2dObjd0RDJub1NLNVUxQnRYUS9leGVj');
let cart = [];

document.addEventListener('keydown', (e) => {
  if(e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || (e.ctrlKey && e.shiftKey && e.key === 'C')) {
    e.preventDefault();
  }
});

let devtoolsOpen = false;
setInterval(() => {
  const start = new Date().getTime();
  debugger;
  const elapsed = new Date().getTime() - start;
  if(elapsed > 50) devtoolsOpen = true;
}, 500);

const testItems = [
  {name: "–ë—Ä–æ–Ω–µ–º–∞—à–∏–Ω–∞", category: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", price: 5000, currency: "$", image: "https://i.imgur.com/3qsJXDT.jpeg", description: "–õ–µ–≥–∫–∞—è –±—Ä–æ–Ω—è –¥–ª—è —Å–ø–µ—Ü–æ–ø–µ—Ä–∞—Ü–∏–π"},
  {name: "AR-15", category: "–í–æ–æ—Ä—É–∂–µ–Ω–∏–µ", price: 800, currency: "$", image: "https://i.imgur.com/3qsJXDT.jpeg", description: "–®—Ç—É—Ä–º–æ–≤–∞—è –≤–∏–Ω—Ç–æ–≤–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞"},
  {name: "–î—Ä–æ–Ω-—Ä–∞–∑–≤–µ–¥—á–∏–∫", category: "–¢–µ—Ö–Ω–∏–∫–∞", price: 2500, currency: "$", image: "https://i.imgur.com/3qsJXDT.jpeg", description: "–†–∞–∑–≤–µ–¥–∫–∞ –∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –Ω–∞ –≤—ã—Å–æ—Ç–µ"},
  {name: "–ú–µ–¥–∏–∫–∞–º–µ–Ω—Ç—ã", category: "–ú–µ–¥–∏—Ü–∏–Ω–∞", price: 1200, currency: "$", image: "https://i.imgur.com/3qsJXDT.jpeg", description: "–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç –¥–ª—è –ø–æ–ª–µ–≤–æ–≥–æ –≥–æ—Å–ø–∏—Ç–∞–ª—è"},
  {name: "–†–∞–¥–∏–æ—Å—Ç–∞–Ω—Ü–∏—è", category: "–°–≤—è–∑—å", price: 650, currency: "$", image: "https://i.imgur.com/3qsJXDT.jpeg", description: "–®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–≤—è–∑—å –Ω–∞ 50 –∫–º"}
];

const catalog = document.getElementById("catalog");
const menu = document.getElementById("categoryMenu");
const groups = {};

testItems.forEach(i => {
  const c = i.category || "–ü—Ä–æ—á–∏–µ –∑–∞–∫–∞–∑—ã";
  (groups[c] = groups[c] || []).push(i);
});

for(const c in groups) {
  const anchor = c.replace(/\s+/g, "_");
  catalog.innerHTML += `<div class="category-title" id="cat-${anchor}">üìã ${c}</div>`;
  menu.innerHTML += `<a href="#" data-target="cat-${anchor}">${c}</a>`;
  
  groups[c].forEach(i => {
    const id = i.name.replace(/\s+/g, "_");
    catalog.innerHTML += `
      <div class="card">
        <img src="${i.image}" alt="${i.name}" onerror="this.src='https://via.placeholder.com/280x200/1a3b5d/ffffff?text=${i.name}'">
        <h3>${i.name}</h3>
        <p>${i.description}</p>
        <div class="price">${i.price.toLocaleString()} ${i.currency}</div>
        <label style="font-size:12px;color:#a0d4ff;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
        <input id="q-${id}" class="qty-input" type="number" value="1" min="1">
        <button class="btn" onclick="handleAddToCart('${i.name.replace(/'/g,'\\\\\'')}',${i.price},'q-${id}')">‚úì –í –∑–∞–∫–∞–∑</button>
      </div>`;
  });
}

document.addEventListener("click", e => {
  const link = e.target.closest("[data-target]");
  if(!link) return;
  e.preventDefault();
  document.getElementById(link.dataset.target).scrollIntoView({behavior: "smooth", block: "start"});
});

function initScrollSpy() {
  const sections = [...document.querySelectorAll(".category-title")];
  const links = [...document.querySelectorAll(".category-menu a")];
  window.addEventListener("scroll", () => {
    let current = null;
    sections.forEach(s => {
      if(s.getBoundingClientRect().top <= 120) current = s;
    });
    if(!current) return;
    links.forEach(l => l.classList.remove("active"));
    const a = links.find(l => l.dataset.target === current.id);
    if(a) a.classList.add("active");
  });
  window.dispatchEvent(new Event("scroll"));
}

initScrollSpy();

function handleAddToCart(name, price, inputId) {
  const qty = parseInt(document.getElementById(inputId).value) || 1;
  addToCart(name, price, qty);
}

function addToCart(name, price, qty) {
  qty = parseInt(qty) || 1;
  price = parseFloat(price) || 0;
  const f = cart.find(i => i.name === name);
  if(f) {
    f.qty += qty;
    f.total = f.qty * price;
  } else {
    cart.push({name, qty, total: qty * price});
  }
  renderCart();
}

function removeFromCart(i) {
  cart.splice(i, 1);
  renderCart();
}

function renderCart() {
  const box = document.getElementById("cart");
  const total = document.getElementById("total");
  box.innerHTML = "";
  let sum = 0;
  
  if(cart.length === 0) {
    box.innerHTML = '<p style="color:#8eb8ff;font-size:13px;">–ó–∞–∫–∞–∑ –ø—É—Å—Ç</p>';
  }
  
  cart.forEach((i, idx) => {
    sum += i.total;
    box.innerHTML += `
      <div class="cart-item">
        <span>${i.name} √ó${i.qty} = $${i.total.toLocaleString()}</span>
        <button class="btn btn-del" onclick="removeFromCart(${idx})">‚úï</button>
      </div>`;
  });
  total.textContent = sum.toLocaleString();
}

function sendOrder() {
  if(!cart.length) {
    alert("‚ö†Ô∏è –ó–∞–∫–∞–∑ –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã.");
    return;
  }

  const name = document.getElementById("customerName").value.trim();
  const phone = document.getElementById("customerPhone").value.trim();
  
  if(!name || !phone) {
    alert("‚ö†Ô∏è –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –§–ò–û –∏ —Ç–µ–ª–µ—Ñ–æ–Ω");
    return;
  }

  const email = document.getElementById("customerEmail").value.trim();
  
  const orderData = {
    action: 'saveOrder',
    name: name,
    phone: phone,
    email: email,
    items: cart,
    itemsText: cart.map(i => `${i.name} (√ó${i.qty}) = $${i.total}`).join(" | "),
    totalSum: cart.reduce((sum, i) => sum + i.total, 0),
    timestamp: new Date().toLocaleString('ru-RU')
  };

  fetch(SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    body: JSON.stringify(orderData)
  })
  .then(() => {
    alert("‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º—É!");
    cart = [];
    renderCart();
    document.getElementById("customerName").value = "";
    document.getElementById("customerPhone").value = "";
    document.getElementById("customerEmail").value = "";
  })
  .catch(err => {
    alert("‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ Google Sheet)");
    cart = [];
    renderCart();
    document.getElementById("customerName").value = "";
    document.getElementById("customerPhone").value = "";
    document.getElementById("customerEmail").value = "";
  });
}
</script>

</body>
</html>
